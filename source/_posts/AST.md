---
title: AST
date: 2018-09-24 16:33:49
categories:
    - front-end
tags:
    - AST
---

# AST

## AST 简介

> 在计算机科学中, 抽象语法树(Abstract Syntax Tree, AST)或者简称语法树(Syntax Tree)是源代码语法解构的一种抽象表现, 它以树状的形式表现编程语言的语法结构，树上的每个节点都表示源代码中的一种结构. -- [维基百科](https://zh.wikipedia.org/wiki/%E6%8A%BD%E8%B1%A1%E8%AA%9E%E6%B3%95%E6%A8%B9)

而在 JavaScript 中我们通过 JavaScript Parser 把代码转化为一颗抽象语法树（AST），这颗树定义了代码的结构，通过操纵这颗树，我们可以精准的定位到声明语句、赋值语句、运算语句等等，实现对代码的分析、优化、变更等操作. 然后浏览器会把 js 源码通过解析器转为抽象语法树，再进一步转化为字节码或直接生成机器码. -- [简书文章](https://www.jianshu.com/p/b9f14f384954)

关于 Vue 的语法树解析可以查看[这里](https://github.com/answershuto/learnVue/blob/master/docs/%E8%81%8A%E8%81%8AVue%E7%9A%84template%E7%BC%96%E8%AF%91.MarkDown)
<!-- more -->

## AST 生成过程

总的来说一段源代码在执行之前会经历如下过程:

1. 分词 / 词法分析: 将一个语句中的关键词进行提取, 例如`let a = 3;`, 分词提取之后得到`let`, `a`, `=`, `3`, `;`
2. 解析 / 语法分析: 在对上面已经被拆分提取过的关键词进行分析之后建立一课语法树(`AST`), 效果可参见下面
3. 底层代码生成: 得到语法树之后执行引擎(例如 chrome 的 v8引擎)会对这颗树进行一定的优化分析, 然后生成更底层的代码或者机器指令交由机器执行

无图不真相, 我们借助一个在线的[可视化工具](https://resources.jointjs.com/demos/javascript-ast)或者[esprima](https://esprima.org/demo/parse.html#)来具体看一下过程, 对于如下代码进行生成 AST 树

1. 源码:

    ```JavaScript
    var a = 42;
    var b = 5;
    function addA(d) {
        return a + d;
    }
    var c = addA(2) + b;
    ```

2. 词法分析结果

    ```text
    Keyword(var) Identifier(a) Punctuator(=) Numeric(42) Punctuator(;) Keyword(var) Identifier(b) Punctuator(=)
    Numeric(5) Punctuator(;) Keyword(function) Identifier(addA) Punctuator(() Identifier(d) Punctuator())
    Punctuator({)Keyword(return) Identifier(a) Punctuator(+) Identifier(d)Punctuator(;)
    Punctuator(}) Keyword(var) Identifier(c) Punctuator(=) Identifier(addA)
    Punctuator(()Numeric(2) Punctuator()) Punctuator(+) Identifier(b) Punctuator(;)
    ```

3. 生成 AST 树

    <img style="width: 300px; heitht: 300px" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20version%3D%221.1%22%20id%3D%22v-151%22%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%20600%201190%22%3E%3Cdefs%20id%3D%22v-4%22%3E%3Cmarker%20id%3D%22v-2-857093843%22%20orient%3D%22auto%22%20overflow%3D%22visible%22%20markerUnits%3D%22userSpaceOnUse%22%3E%3Cpath%20id%3D%22v-127%22%20stroke%3D%22%23666%22%20fill%3D%22%23666%22%20transform%3D%22rotate(180)%22%20d%3D%22M%204%20-4%200%200%204%204%20z%22%2F%3E%3C%2Fmarker%3E%3C%2Fdefs%3E%3Cg%20id%3D%22v-3%22%20class%3D%22joint-viewport%22%3E%3Cg%20model-id%3D%220575a616-604c-455a-a0ef-e26b748b98ab%22%20id%3D%22j_1%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(0%2C0)%22%3E%3Crect%20id%3D%22v-6%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22black%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-7%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C37.8%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3EProgram%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-8%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22170a8aff-943a-4d5b-ac39-114c9f602e9b%22%20id%3D%22j_21%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(320%2C1150)%22%3E%3Crect%20id%3D%22v-106%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23ff5246%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-107%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C57%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3Eb%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-108%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22c6859033-e970-457f-be98-1f1155b15b62%22%20id%3D%22j_22%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(80%2C50)%22%3E%3Crect%20id%3D%22v-111%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23232323%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-112%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C7.9%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3EVariableDeclaration%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-113%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%2282155076-1860-4d62-9299-94a7d5696b7b%22%20id%3D%22j_23%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(240%2C900)%22%3E%3Crect%20id%3D%22v-116%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23fcbc2a%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-117%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C57%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3E%2B%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-118%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%226ae2936e-d297-4ea2-b358-ea760462f013%22%20id%3D%22j_20%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(400%2C650)%22%3E%3Crect%20id%3D%22v-101%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23ff5246%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-102%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C57.3%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3Ea%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-103%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%2200527959-5960-43af-a963-fff4b2e4bdf0%22%20id%3D%22j_25%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-126%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20140%20280%20L%20140%20315%20L%20160%20315%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22be60f611-cd88-40b4-8df0-79d83e399d2a%22%20id%3D%22j_26%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-129%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20300%20930%20L%20300%201165%20L%20320%201165%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22f2233185-5f97-4f4a-99c0-0c748d07c2c5%22%20id%3D%22j_27%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-130%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20220%20830%20L%20220%20915%20L%20240%20915%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%229cd1bf03-f527-4b8f-b041-7811e6e6f207%22%20id%3D%22j_28%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-131%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20300%20580%20L%20300%20615%20L%20320%20615%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22df4cb4db-223c-4a5b-957d-711034a4bf64%22%20id%3D%22j_29%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-132%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%2060%2030%20L%2060%20265%20L%2080%20265%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%224b5abfb2-484e-46a6-af0f-22540068b7ce%22%20id%3D%22j_19%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(160%2C100)%22%3E%3Crect%20id%3D%22v-96%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23414141%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-97%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C10.7%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3EVariableDeclarator%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-98%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22e203c45b-b788-41f9-8dcf-ede427cfbf4d%22%20id%3D%22j_30%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-133%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20380%20630%20L%20380%20665%20L%20400%20665%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22d6530e93-dc7d-4c20-980a-64b3ba88afb8%22%20id%3D%22j_18%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(240%2C550)%22%3E%3Crect%20id%3D%22v-91%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23232323%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-92%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C14.9%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3EReturnStatement%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-93%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%224f24a926-2447-4fa1-ac1a-da6767ecf356%22%20id%3D%22j_31%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-134%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20300%20930%20L%20300%20965%20L%20320%20965%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22e9b555f0-ea57-4192-acc2-66f395661459%22%20id%3D%22j_17%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(480%2C1100)%22%3E%3Crect%20id%3D%22v-86%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%2377c63d%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-87%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C57.2%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3E2%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-88%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%2236c11933-8bc0-4098-b092-a59f9e2c99f5%22%20id%3D%22j_32%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-135%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20380%20630%20L%20380%20715%20L%20400%20715%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22cad8dd4f-91c0-4789-b5aa-02eae8640c50%22%20id%3D%22j_16%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(400%2C700)%22%3E%3Crect%20id%3D%22v-81%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23ff5246%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-82%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C57%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3Ed%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-83%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%222b50fe52-2731-41bc-b3bf-74df89127470%22%20id%3D%22j_33%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-136%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20220%20130%20L%20220%20215%20L%20240%20215%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22babe2e26-e654-4393-994d-78fbb50bcc87%22%20id%3D%22j_15%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(240%2C150)%22%3E%3Crect%20id%3D%22v-76%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23ff5246%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-77%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C57.3%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3Ea%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-78%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%2282e8806c-d30d-43fa-b3e7-ab92cb8b3b57%22%20id%3D%22j_34%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-137%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%2060%2030%20L%2060%20765%20L%2080%20765%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22a3469a79-1a18-499d-82fa-a7f1d857082f%22%20id%3D%22j_14%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(160%2C500)%22%3E%3Crect%20id%3D%22v-71%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23232323%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-72%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C17.8%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3EBlockStatement%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-73%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%225b8fb7b2-e2cf-4e2b-a668-a61d3aaab065%22%20id%3D%22j_35%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-138%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20380%20980%20L%20380%201015%20L%20400%201015%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22967abd22-7594-482a-ac7c-d0392004d0c0%22%20id%3D%22j_13%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(400%2C1050)%22%3E%3Crect%20id%3D%22v-66%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%2363c1f1%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-67%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C32.3%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3Earguments%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-68%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%228db55fd0-0827-4e3c-876d-80b049ff3d77%22%20id%3D%22j_36%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-139%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20140%20780%20L%20140%20815%20L%20160%20815%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%2212806624-ac4c-4b74-97fa-0045761cee49%22%20id%3D%22j_12%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(80%2C750)%22%3E%3Crect%20id%3D%22v-61%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23232323%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-62%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C7.9%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3EVariableDeclaration%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-63%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22f0b73dfc-2324-4734-b162-32955bc345a5%22%20id%3D%22j_37%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-140%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20220%20130%20L%20220%20165%20L%20240%20165%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22cfd70751-157f-4b97-ac3a-21cc81f62bf4%22%20id%3D%22j_11%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(240%2C200)%22%3E%3Crect%20id%3D%22v-56%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%2377c63d%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-57%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C53.9%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3E42%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-58%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%2254b43d7a-93ee-4080-b6d3-fdfef5f3a973%22%20id%3D%22j_38%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-141%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20220%20830%20L%20220%20865%20L%20240%20865%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22be156511-ce0c-4e34-825d-5ae6739fa349%22%20id%3D%22j_10%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(80%2C450)%22%3E%3Crect%20id%3D%22v-51%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23232323%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-52%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C15.6%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3Efunction%C2%A0addA(d)%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-53%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22dbc524b4-32c6-4951-8c5a-2565f3402bd7%22%20id%3D%22j_39%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-142%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20140%20480%20L%20140%20515%20L%20160%20515%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22c0beb125-fd3b-4fc6-94f4-8462e74c6adc%22%20id%3D%22j_9%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(160%2C800)%22%3E%3Crect%20id%3D%22v-46%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23414141%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-47%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C10.7%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3EVariableDeclarator%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-48%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22aa5b04fd-f487-4c1d-96aa-320c6917b5cf%22%20id%3D%22j_40%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-143%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%2060%2030%20L%2060%2065%20L%2080%2065%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%228e58b277-e590-4f20-a319-b5b31f9caa82%22%20id%3D%22j_8%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(240%2C400)%22%3E%3Crect%20id%3D%22v-41%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%2377c63d%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-42%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C57.2%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3E5%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-43%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22bbd0e695-ff24-4ed0-b32b-00b1f9b3fcc7%22%20id%3D%22j_41%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-144%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20460%201080%20L%20460%201115%20L%20480%201115%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22be43f345-2f25-47d4-9108-bbacb4b00d76%22%20id%3D%22j_7%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(240%2C850)%22%3E%3Crect%20id%3D%22v-36%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23ff5246%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-37%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C57.3%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3Ec%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-38%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22aa48ee7f-f636-4e39-bead-ebf4e5618f76%22%20id%3D%22j_42%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-145%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20140%2080%20L%20140%20115%20L%20160%20115%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%2279ee0a45-bb59-415a-adfc-5be54602ee19%22%20id%3D%22j_6%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(240%2C350)%22%3E%3Crect%20id%3D%22v-31%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23ff5246%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-32%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C57%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3Eb%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-33%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%2211b62819-4f6c-4085-95f9-1faf5ae075ad%22%20id%3D%22j_43%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-146%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20380%20980%20L%20380%201065%20L%20400%201065%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%225b23512d-12ce-45a3-a39c-4a02c5770220%22%20id%3D%22j_5%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(400%2C1000)%22%3E%3Crect%20id%3D%22v-26%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23ff5246%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-27%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C46.6%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3EaddA%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-28%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22c83ae87c-0bc6-4a3c-9750-588d97be6312%22%20id%3D%22j_44%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-147%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%2060%2030%20L%2060%20465%20L%2080%20465%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%221dc65a22-7066-4896-83f4-6e6f5562386f%22%20id%3D%22j_4%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(160%2C300)%22%3E%3Crect%20id%3D%22v-21%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23414141%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-22%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C10.7%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3EVariableDeclarator%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-23%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%220134f072-a6ea-499c-9432-f06fbb515403%22%20id%3D%22j_45%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-148%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20220%20530%20L%20220%20565%20L%20240%20565%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22e927ad0c-8128-45fd-bbd6-f176bc7ec23f%22%20id%3D%22j_3%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(320%2C950)%22%3E%3Crect%20id%3D%22v-16%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23232323%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-17%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C20.4%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3ECallExpression%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-18%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%2276c82168-c906-4249-9646-829a6278d656%22%20id%3D%22j_46%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-149%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20220%20330%20L%20220%20365%20L%20240%20365%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%225160889d-e32b-4246-8d12-2c84c05abda7%22%20id%3D%22j_2%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(80%2C250)%22%3E%3Crect%20id%3D%22v-11%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23232323%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-12%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C7.9%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3EVariableDeclaration%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-13%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%22374a7edb-7f45-4bf4-9cf6-00862bdb4bb6%22%20id%3D%22j_47%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-link%20joint-link%20joint-theme-default%22%20data-type%3D%22ast.Link%22%3E%3Cpath%20class%3D%22connection%22%20id%3D%22v-150%22%20fill%3D%22none%22%20stroke%3D%22%23666%22%20pointer-events%3D%22none%22%20marker-end%3D%22url(%23v-2-857093843)%22%20d%3D%22M%20220%20330%20L%20220%20415%20L%20240%20415%22%2F%3E%3C%2Fg%3E%3Cg%20model-id%3D%222dfbf5af-950d-4359-8f75-f6fc3d5ef508%22%20id%3D%22j_24%22%20class%3D%22joint-cell%20joint-type-ast%20joint-type-ast-node%20joint-element%20joint-theme-default%22%20data-type%3D%22ast.Node%22%20transform%3D%22translate(320%2C600)%22%3E%3Crect%20id%3D%22v-121%22%20rx%3D%225%22%20ry%3D%225%22%20stroke%3D%22none%22%20fill%3D%22%23fcbc2a%22%20width%3D%22120%22%20height%3D%2230%22%2F%3E%3Ctext%20id%3D%22v-122%22%20font-size%3D%2210%22%20xml%3Aspace%3D%22preserve%22%20y%3D%220.8em%22%20fill%3D%22white%22%20font-family%3D%22'Helvetica%20Neue%20Light'%2C'Helvetica%20Neue'%2C'Source%20Sans%20Pro'%2Csans-serif%22%20letter-spacing%3D%221px%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C57%2C10.7)%22%3E%3Ctspan%20dy%3D%220%22%20class%3D%22v-line%22%3E%2B%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20id%3D%22v-123%22%20stroke%3D%22%23666%22%20d%3D%22M%200%200%200%2010%20M%20-5%2010%205%2010%22%20visibility%3D%22hidden%22%20pointer-events%3D%22none%22%20transform%3D%22matrix(1%2C0%2C0%2C1%2C60%2C30)%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3Cg%20id%3D%22v-5%22%20class%3D%22joint-tools-container%22%20transform%3D%22matrix(1.0227966101694916%2C0%2C0%2C1.0227966101694916%2C0%2C0)%22%2F%3E%3C%2Fsvg%3E" style="max-height:100%">

    或者我们可以使用 json 格式来查看
    ```json
    {
        "type": "Program",
        "body": [
            {
                "type": "VariableDeclaration",
                "declarations": [
                    {
                        "type": "VariableDeclarator",
                        "id": {
                            "type": "Identifier",
                            "name": "a"
                        },
                        "init": {
                            "type": "Literal",
                            "value": 42,
                            "raw": "42"
                        }
                    }
                ],
                "kind": "var"
            },
            {
                "type": "VariableDeclaration",
                "declarations": [
                    {
                        "type": "VariableDeclarator",
                        "id": {
                            "type": "Identifier",
                            "name": "b"
                        },
                        "init": {
                            "type": "Literal",
                            "value": 5,
                            "raw": "5"
                        }
                    }
                ],
                "kind": "var"
            },
            {
                "type": "FunctionDeclaration",
                "id": {
                    "type": "Identifier",
                    "name": "addA"
                },
                "params": [
                    {
                        "type": "Identifier",
                        "name": "d"
                    }
                ],
                "body": {
                    "type": "BlockStatement",
                    "body": [
                        {
                            "type": "ReturnStatement",
                            "argument": {
                                "type": "BinaryExpression",
                                "operator": "+",
                                "left": {
                                    "type": "Identifier",
                                    "name": "a"
                                },
                                "right": {
                                    "type": "Identifier",
                                    "name": "d"
                                }
                            }
                        }
                    ]
                },
                "generator": false,
                "expression": false,
                "async": false
            },
            {
                "type": "VariableDeclaration",
                "declarations": [
                    {
                        "type": "VariableDeclarator",
                        "id": {
                            "type": "Identifier",
                            "name": "c"
                        },
                        "init": {
                            "type": "BinaryExpression",
                            "operator": "+",
                            "left": {
                                "type": "CallExpression",
                                "callee": {
                                    "type": "Identifier",
                                    "name": "addA"
                                },
                                "arguments": [
                                    {
                                        "type": "Literal",
                                        "value": 2,
                                        "raw": "2"
                                    }
                                ]
                            },
                            "right": {
                                "type": "Identifier",
                                "name": "b"
                            }
                        }
                    }
                ],
                "kind": "var"
            }
        ],
        "sourceType": "script"
    }
    ```

## AST的作用

除了帮助执行引擎去生成底层的代码, AST 在我们常见的代码检查工具或者 webpack 中都可以用来作为代码分析的依据, 通过遍历 AST 树, 找出其中的隐藏问题, 或者提出优化的建议, 又或者是代码高亮或者代码压缩都是在分析这颗树的基础上进行的

## 浏览器渲染过程

首先我们看一下浏览器的深层结构:

1. 用户界面-包括地址栏, 返回按钮等 UI 组件, 除了主窗口
2. 浏览器引擎-用来查询和操作渲染引擎的接口
3. 渲染引擎-负责渲染请求的内容. 比如, 如果请求的资源是html, 那么渲染引擎负责解析 html 和 css, 然后把解析结果渲染到页面中
4. js 引擎-用来解析执行 JavaScript 代码
5. 网络连接-用于处理网络请求, 如 http 请求. 这一部分是跨平台的
6. UI 后台-用于渲染基础组件, 比如多选框和窗口等, 它暴露了一个不是特定平台的通用接口, 在底层调用了操作系统的用户接口
7. 数据存储-这是一个持久层. 浏览器在硬盘中存储各式数据, 比如 cookie , localStorage 等

各个组件的关系如下:
![浏览器组件关系](https://segmentfault.com/img/bVMk2D?w=500&h=339)

我们需要注意的是, js 引擎是单线程的, 但是浏览器是多线程的, 比如浏览器会同时开启js 引擎线程, 界面渲染线程, 事件触发线程, http 请求线程

> HTML5提出Web Worker标准，允许JavaScript脚本创建多个线程，但是子线程完全受主线程控制，且不得操作DOM。所以，这个新标准并没有改变JavaScript单线程的本质。

接下来我们着重看一下渲染引擎所做的工作:
总的过程是: 解析HTML并构建DOM树 => 构建render树 => render树布局 => render树绘制
浏览器引擎开始解析 html, 并把标签转为内容树中的 dom 节点, 同时它也开始解析 css, 外链的 css 以及文件内的 css, 所有这些样式数据以及 html 中的可见性指令都用来构建另外一棵树,  -- render 树
我们以Safari 和 chrome 使用的Webkit 引擎渲染过程如下:
![Webkit 主流程](https://segmentfault.com/img/bVHJfZ?w=624&h=289)
firefox使用的Gecko 引擎渲染过程如下:
![Gecko 主流程](https://segmentfault.com/img/bVHJfZ?w=624&h=289)

此小节内容参考与 segmentfault 上cucumber翻译的文章:
[浏览器工作过程详解（译）（一）](https://segmentfault.com/a/1190000009108377)
[浏览器工作过程详解（译）（二）](https://segmentfault.com/a/1190000009236417)
