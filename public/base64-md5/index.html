<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="It&#39;s my personal blog."><meta name="keywords" content="blog,kricsleo,IT,Web Front End"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Base64-md5 | kricsleo</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="alternate" href="/atom.xml" title="kricsleo"><style>@font-face{font-family:RobotoMono-Iconfont;font-style:normal;font-display:swap;src:url(/fonts/RobotoMono-Iconfont.woff) format("woff")}.loader{position:fixed;width:100%;height:100%;top:0;left:0;background-color:rgba(255,255,255,.7);z-index:999;transition:all .4s}.loader:before{content:'';display:block;position:absolute;left:50%;top:50%;width:50px;height:50px;margin-top:-25px;margin-left:-25px;background-color:#0097e4;-webkit-animation:rotateplane 1.2s infinite ease-in-out;animation:rotateplane 1.2s infinite ease-in-out}.loader:after{content:'loading';font-family:RobotoMono-Iconfont;visibility:hidden}@-webkit-keyframes rotateplane{0%{-webkit-transform:perspective(120px)}50%{-webkit-transform:perspective(120px) rotateY(180deg)}100%{-webkit-transform:perspective(120px) rotateY(180deg) rotateX(180deg)}}@keyframes rotateplane{0%{transform:perspective(120px) rotateX(0) rotateY(0);-webkit-transform:perspective(120px) rotateX(0) rotateY(0)}50%{transform:perspective(120px) rotateX(-180.1deg) rotateY(0);-webkit-transform:perspective(120px) rotateX(-180.1deg) rotateY(0)}100%{transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg);-webkit-transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg)}}</style></head></html><body><div class="loader"></div><header class="l_header" style="display:none"><div class="wrapper"><div class="nav-main container container--flex"><a class="logo flat-box" href="/">kricsleo</a><div class="menu"><ul class="h-list"><li><a class="flat-box nav-home" href="/">Home</a></li><li><a class="flat-box nav-archives" href="/archives">Archives</a></li><li><a class="flat-box nav-about" href="https://github.com/kricsleo">About</a></li></ul><div class="underline"></div></div><div class="m_search"><form name="searchform" class="form u-search-form"><input type="text" class="input u-search-input" placeholder="Search"> <span class="iconfont icon-search"></span></form></div><ul class="switcher h-list"><li class="s-search"><a href="javascript:void(0)"><span class="iconfont icon-search flat-box"></span></a></li><li class="s-menu"><a href="javascript:void(0)"><span class="iconfont icon-menu flat-box"></span></a></li></ul></div><div class="nav-sub container container--flex"><a class="logo" href="javascript:void(0)">Word of Forks</a><ul class="switcher h-list"><li class="s-comment"><a href="javascript:void(0)"><span class="iconfont icon-chat_bubble_outline flat-box"></span></a></li><li class="s-top"><a href="javascript:void(0)"><span class="iconfont icon-arrow_upward flat-box"></span></a></li><li class="s-toc"><a href="javascript:void(0)"><span class="iconfont icon-format_list_numbered flat-box"></span></a></li></ul></div></div></header><div class="l_body" style="display:none"><div class="container clearfix"><div class="l_main"><article id="post-base64-md5" class="post white-box article-type-post" itemscope itemprop="blogPost"><section class="toc-wrapper active"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Base64编码与md5摘要算法探究及日常应用"><span class="toc-number">1.</span> <span class="toc-text">Base64编码与md5摘要算法探究及日常应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Base64"><span class="toc-number">1.1.</span> <span class="toc-text">Base64</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Base64来源"><span class="toc-number">1.1.1.</span> <span class="toc-text">Base64来源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#quoted-printable编码"><span class="toc-number">1.1.2.</span> <span class="toc-text">quoted-printable编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Base64编码"><span class="toc-number">1.1.3.</span> <span class="toc-text">Base64编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Base64编码示例"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">Base64编码示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Base64在js中的使用"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">Base64在js中的使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#md5摘要算法"><span class="toc-number">1.2.</span> <span class="toc-text">md5摘要算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#md5的js实现如下"><span class="toc-number">1.2.1.</span> <span class="toc-text">md5的js实现如下:</span></a></li></ol></li></ol></li></ol></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><h1 id="Base64编码与md5摘要算法探究及日常应用"><a href="#Base64编码与md5摘要算法探究及日常应用" class="headerlink" title="Base64编码与md5摘要算法探究及日常应用"></a>Base64编码与md5摘要算法探究及日常应用</h1><p>Base64编码和md5摘要算法我们经常听到,本文主要对着两者算法做一个简单的了解探究<br><a id="more"></a></p><h2 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h2><p>Base64是一种基于64个可打印字符来表示二进制数据的表示方法,常用于在通常处理文本数据的场合，表示、传输、存储一些二进制数据，包括MIME的电子邮件及XML的一些复杂数据。</p><h3 id="Base64来源"><a href="#Base64来源" class="headerlink" title="Base64来源"></a>Base64来源</h3><p>Base64来源于电子邮件的发展,早期的电子邮件是不支持二进制文件(例如图片)的,并且邮件中也不支持非英语字符,邮件也不能有附件,再后来的发展中工程师对电子邮件的技术规范就行了扩充,也就产生了常说的<code>MIME</code>,全称是全”Multipurpose Internet Mail Extensions”，中译为”多用途互联网邮件扩展”,它包括了多项技术规范.<br>一封传统的电子邮件格式如下:<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">From: &quot;Tommy Lee&quot; &lt;lee@example.com&gt;</span><br><span class="line">To: &quot;Jack Zhang&quot; &lt;zhang@example.com&gt;</span><br><span class="line">Subject: Test</span><br><span class="line">Date: Wed, 17 May 2000 19:08:29 -0400</span><br><span class="line">Message-ID: &lt;NDBBIAKOPKHFGPLCODIGIEKBCHAA.lee@example.com&gt;</span><br><span class="line"></span><br><span class="line">Hello World.</span><br></pre></td></tr></table></figure><p></p><p>它包含两个部分,第一部分是信封,里面包含发件人,收件人,邮件主题,邮件发送时间,邮件的唯一标识Message-ID,第二部分是正文,也就是邮件的内容,第一部分和第二部分之间用一个空行隔开,</p><p><code>MIME</code>对传统邮件的扩展体现在在信封里面新增了三行语句</p><ol><li>MIME-Version: 1.0<br>这行语句标志着该邮件使用了<code>MIME</code>规范,收信端将按照该规范进行解析邮件内容</li><li><p>Content-Type: text/plain; charset=”UTF-8”<br>这行语句说明了改邮件的信息类型和编码方式<br>Content-Type表明信息类型，缺省值为” text/plain”<br>它包含了主要类型（primary type）和次要类型（subtype）两个部分，两者之间用”/“分割。主要类型有9种，分别是application、audio、example、image、message、model、multipart、text、video,每种主要类型下面又分为多种次要类型,常用的一些Content-Type类型如下:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">text/plain：纯文本，文件扩展名.txt</span><br><span class="line">text/html：HTML文本，文件扩展名.htm和.html</span><br><span class="line">image/jpeg：jpeg格式的图片，文件扩展名.jpg</span><br><span class="line">image/gif：GIF格式的图片，文件扩展名.gif</span><br><span class="line">audio/x-wave：WAVE格式的音频，文件扩展名.wav</span><br><span class="line">audio/mpeg：MP3格式的音频，文件扩展名.mp3</span><br><span class="line">video/mpeg：MPEG格式的视频，文件扩展名.mpg</span><br><span class="line">application/zip：PK-ZIP格式的压缩文件，文件扩展名.zip</span><br></pre></td></tr></table></figure><p>如果信息的主要类型是”text”，那么还必须指明编码类型”charset”，缺省值是ASCII，其他可能值有”ISO-8859-1”、”UTF-8”、”GB2312”等等。</p></li><li>Content-transfer-encoding: Base64<br>这里我们的主角就登场了,这行语句表明邮件编码转换的方式,因为现代邮件里面会有图片或者其它原始邮件不支持的内容,那么在发送的时候就需要对内容进行编码转换,将内容转换成邮件支持的<a href="https//tool.oschina.net/commons?type=4">ASCII字符</a>,Content-transfer-encoding的值有5种—-“7bit”、”8bit”、”binary”、”quoted-printable”和”Base64”—-其中”7bit”是缺省值，即不用转化的ASCII字符。真正常用是”quoted-printable”和”Base64”两种.</li></ol><h3 id="quoted-printable编码"><a href="#quoted-printable编码" class="headerlink" title="quoted-printable编码"></a>quoted-printable编码</h3><p>关于’quoted-printable’简单介绍一下,它主要用于ACSII文本中夹杂少量非ASCII码字符的情况，不适合于转换纯二进制文件.<br>它规定将每一个8位的字节，转换为3个字符,规则如下:</p><ol><li>所有可打印的ASCII码字符（十进制值从33到126）都保持原样不变，”=”（十进制值61）除外,其余的字符都要进行编码。</li><li>编码后第一个字符是”=”号，这是固定不变的;</li><li>编码后二个字符是二个十六进制数，分别代表了这个字节前四位和后四位的数值。<br>例如ASCII码中的换页键的码值是12,那么先转成8位的二进制是00001100,再转成16进制是0C,然后再在前面加上一个’=’号,最后的编码结果是’=0C’.</li></ol><h3 id="Base64编码"><a href="#Base64编码" class="headerlink" title="Base64编码"></a>Base64编码</h3><p>首先选出一个字符集,分别是小写字母a-z、大写字母A-Z、数字0-9、符号”+”、”/“加起来是64个,另外有一个垫字符’=’,然后将其它所有不在这个字符集里面的字符都转换到到这个字符集里面去,转换规则如下:</p><ol><li>将每三个字节作为一组，一共是24个二进制位;</li><li>再将这24个二进制位分为四组，每个组有6个二进制位;</li><li>在每组前面加两个00，扩展成32个二进制位，即四个字节;</li><li>查询<a href="https://blog.csdn.net/goodlixueyong/article/details/52132250" target="_blank" rel="noopener">字符表</a>,找到每个字节在表中对应的符号，这就是Base64的编码值;<br>所以分析最终的结果的话,原始的三个字节经过转换以后会变成4个字节,因此Base64编码后的文本，会比原文本大出三分之一左右。</li></ol><h4 id="Base64编码示例"><a href="#Base64编码示例" class="headerlink" title="Base64编码示例"></a>Base64编码示例</h4><p>编码译文单词’six’:<br><code>s i x</code> -&lt;转为对应的ASCII值&gt;&gt;&gt; <code>115 105 120</code> -&lt;转为对应的二进制&gt;&gt; <code>01110011 01101001 01111000</code> -&lt;二进制分为四组&gt;&gt; <code>011100 110110 100101 111000</code> -&lt;每组前面添加两个0&gt;&gt; <code>00011100 00110110 00100101 00111000</code> -&lt;每组转为对应的10进制&gt;&gt; <code>28 54 37 56</code> -&lt;查询Base64字符表转为对应字符&gt;&gt; <code>c 2 l 4</code><br>则’six’编码后的结果是’c2l4’,你可以用这个<a href="https//tool.oschina.net/encrypt?type=3">工具</a>来验证你的转码结果是否正确.</p><p>如果字节数不足三，则处理如下:</p><ul><li><p>二个字节的情况：将这二个字节的一共16个二进制位，按照上面的规则，转成三组，最后一组除了前面加两个0以外，后面也要加两个0。这样得到一个三位的Base64编码，再在末尾补上一个”=”号。<br>比如，”Ma”这个字符串是两个字节，可以转化成三组00010011、00010110、00010000以后，对应Base64值分别为T、W、E，再补上一个”=”号，因此”Ma”的Base64编码就是TWE=。</p></li><li><p>一个字节的情况：将这一个字节的8个二进制位，按照上面的规则转成二组，最后一组除了前面加二个0以外，后面再加4个0。这样得到一个二位的Base64编码，再在末尾补上两个”=”号。<br>比如，”M”这个字母是一个字节，可以转化为二组00010011、00010000，对应的Base64值分别为T、Q，再补上二个”=”号，因此”M”的Base64编码就是’TQ==’。</p></li></ul><p>再举一个中文的例子，汉字”严”如何转化成Base64编码？</p><p>这里需要注意，汉字本身可以有多种编码，比如gb2312、utf-8、gbk等等，每一种编码的Base64对应值都不一样。下面的例子以utf-8为例。</p><p>首先，”严”的utf-8编码为E4B8A5，写成二进制就是三字节的”11100100 10111000 10100101”。将这个24位的二进制字符串，按照第3节中的规则，转换成四组一共32位的二进制值”00111001 00001011 00100010 00100101”，相应的十进制数为57、11、34、37，它们对应的Base64值就为5、L、i、l。</p><p>所以，汉字”严”（utf-8编码）的Base64值就是5Lil。</p><h4 id="Base64在js中的使用"><a href="#Base64在js中的使用" class="headerlink" title="Base64在js中的使用"></a>Base64在js中的使用</h4><p>Base64的js实现如下:<br></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  Base64 encode / decode</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  @author haitao.tu</span></span><br><span class="line"><span class="comment">*  @date   2010-04-26</span></span><br><span class="line"><span class="comment">*  @email  tuhaitao@foxmail.com</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Base64</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> </span><br><span class="line">true<span class="comment">// private property</span></span><br><span class="line">true_keyStr = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="</span>;</span><br><span class="line"> </span><br><span class="line">true<span class="comment">// public method for encoding</span></span><br><span class="line">true<span class="keyword">this</span>.encode = <span class="function"><span class="keyword">function</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">truetrue<span class="keyword">var</span> output = <span class="string">""</span>;</span><br><span class="line">truetrue<span class="keyword">var</span> chr1, chr2, chr3, enc1, enc2, enc3, enc4;</span><br><span class="line">truetrue<span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">truetrueinput = _utf8_encode(input);</span><br><span class="line">truetrue<span class="keyword">while</span> (i &lt; input.length) &#123;</span><br><span class="line">truetruetruechr1 = input.charCodeAt(i++);</span><br><span class="line">truetruetruechr2 = input.charCodeAt(i++);</span><br><span class="line">truetruetruechr3 = input.charCodeAt(i++);</span><br><span class="line">truetruetrueenc1 = chr1 &gt;&gt; <span class="number">2</span>;</span><br><span class="line">truetruetrueenc2 = ((chr1 &amp; <span class="number">3</span>) &lt;&lt; <span class="number">4</span>) | (chr2 &gt;&gt; <span class="number">4</span>);</span><br><span class="line">truetruetrueenc3 = ((chr2 &amp; <span class="number">15</span>) &lt;&lt; <span class="number">2</span>) | (chr3 &gt;&gt; <span class="number">6</span>);</span><br><span class="line">truetruetrueenc4 = chr3 &amp; <span class="number">63</span>;</span><br><span class="line">truetruetrue<span class="keyword">if</span> (<span class="built_in">isNaN</span>(chr2)) &#123;</span><br><span class="line">truetruetruetrueenc3 = enc4 = <span class="number">64</span>;</span><br><span class="line">truetruetrue&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isNaN</span>(chr3)) &#123;</span><br><span class="line">truetruetruetrueenc4 = <span class="number">64</span>;</span><br><span class="line">truetruetrue&#125;</span><br><span class="line">truetruetrueoutput = output +</span><br><span class="line">truetruetrue_keyStr.charAt(enc1) + _keyStr.charAt(enc2) +</span><br><span class="line">truetruetrue_keyStr.charAt(enc3) + _keyStr.charAt(enc4);</span><br><span class="line">truetrue&#125;</span><br><span class="line">truetrue<span class="keyword">return</span> output;</span><br><span class="line">true&#125;</span><br><span class="line"> </span><br><span class="line">true<span class="comment">// public method for decoding</span></span><br><span class="line">true<span class="keyword">this</span>.decode = <span class="function"><span class="keyword">function</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">truetrue<span class="keyword">var</span> output = <span class="string">""</span>;</span><br><span class="line">truetrue<span class="keyword">var</span> chr1, chr2, chr3;</span><br><span class="line">truetrue<span class="keyword">var</span> enc1, enc2, enc3, enc4;</span><br><span class="line">truetrue<span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">truetrueinput = input.replace(<span class="regexp">/[^A-Za-z0-9\+\/\=]/g</span>, <span class="string">""</span>);</span><br><span class="line">truetrue<span class="keyword">while</span> (i &lt; input.length) &#123;</span><br><span class="line">truetruetrueenc1 = _keyStr.indexOf(input.charAt(i++));</span><br><span class="line">truetruetrueenc2 = _keyStr.indexOf(input.charAt(i++));</span><br><span class="line">truetruetrueenc3 = _keyStr.indexOf(input.charAt(i++));</span><br><span class="line">truetruetrueenc4 = _keyStr.indexOf(input.charAt(i++));</span><br><span class="line">truetruetruechr1 = (enc1 &lt;&lt; <span class="number">2</span>) | (enc2 &gt;&gt; <span class="number">4</span>);</span><br><span class="line">truetruetruechr2 = ((enc2 &amp; <span class="number">15</span>) &lt;&lt; <span class="number">4</span>) | (enc3 &gt;&gt; <span class="number">2</span>);</span><br><span class="line">truetruetruechr3 = ((enc3 &amp; <span class="number">3</span>) &lt;&lt; <span class="number">6</span>) | enc4;</span><br><span class="line">truetruetrueoutput = output + <span class="built_in">String</span>.fromCharCode(chr1);</span><br><span class="line">truetruetrue<span class="keyword">if</span> (enc3 != <span class="number">64</span>) &#123;</span><br><span class="line">truetruetruetrueoutput = output + <span class="built_in">String</span>.fromCharCode(chr2);</span><br><span class="line">truetruetrue&#125;</span><br><span class="line">truetruetrue<span class="keyword">if</span> (enc4 != <span class="number">64</span>) &#123;</span><br><span class="line">truetruetruetrueoutput = output + <span class="built_in">String</span>.fromCharCode(chr3);</span><br><span class="line">truetruetrue&#125;</span><br><span class="line">truetrue&#125;</span><br><span class="line">truetrueoutput = _utf8_decode(output);</span><br><span class="line">truetrue<span class="keyword">return</span> output;</span><br><span class="line">true&#125;</span><br><span class="line"> </span><br><span class="line">true<span class="comment">// private method for UTF-8 encoding</span></span><br><span class="line">true_utf8_encode = <span class="function"><span class="keyword">function</span> (<span class="params">string</span>) </span>&#123;</span><br><span class="line">truetruestring = string.replace(<span class="regexp">/\r\n/g</span>,<span class="string">"\n"</span>);</span><br><span class="line">truetrue<span class="keyword">var</span> utftext = <span class="string">""</span>;</span><br><span class="line">truetrue<span class="keyword">for</span> (<span class="keyword">var</span> n = <span class="number">0</span>; n &lt; string.length; n++) &#123;</span><br><span class="line">truetruetrue<span class="keyword">var</span> c = string.charCodeAt(n);</span><br><span class="line">truetruetrue<span class="keyword">if</span> (c &lt; <span class="number">128</span>) &#123;</span><br><span class="line">truetruetruetrueutftext += <span class="built_in">String</span>.fromCharCode(c);</span><br><span class="line">truetruetrue&#125; <span class="keyword">else</span> <span class="keyword">if</span>((c &gt; <span class="number">127</span>) &amp;&amp; (c &lt; <span class="number">2048</span>)) &#123;</span><br><span class="line">truetruetruetrueutftext += <span class="built_in">String</span>.fromCharCode((c &gt;&gt; <span class="number">6</span>) | <span class="number">192</span>);</span><br><span class="line">truetruetruetrueutftext += <span class="built_in">String</span>.fromCharCode((c &amp; <span class="number">63</span>) | <span class="number">128</span>);</span><br><span class="line">truetruetrue&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">truetruetruetrueutftext += <span class="built_in">String</span>.fromCharCode((c &gt;&gt; <span class="number">12</span>) | <span class="number">224</span>);</span><br><span class="line">truetruetruetrueutftext += <span class="built_in">String</span>.fromCharCode(((c &gt;&gt; <span class="number">6</span>) &amp; <span class="number">63</span>) | <span class="number">128</span>);</span><br><span class="line">truetruetruetrueutftext += <span class="built_in">String</span>.fromCharCode((c &amp; <span class="number">63</span>) | <span class="number">128</span>);</span><br><span class="line">truetruetrue&#125;</span><br><span class="line"> </span><br><span class="line">truetrue&#125;</span><br><span class="line">truetrue<span class="keyword">return</span> utftext;</span><br><span class="line">true&#125;</span><br><span class="line"> </span><br><span class="line">true<span class="comment">// private method for UTF-8 decoding</span></span><br><span class="line">true_utf8_decode = <span class="function"><span class="keyword">function</span> (<span class="params">utftext</span>) </span>&#123;</span><br><span class="line">truetrue<span class="keyword">var</span> string = <span class="string">""</span>;</span><br><span class="line">truetrue<span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">truetrue<span class="keyword">var</span> c = c1 = c2 = <span class="number">0</span>;</span><br><span class="line">truetrue<span class="keyword">while</span> ( i &lt; utftext.length ) &#123;</span><br><span class="line">truetruetruec = utftext.charCodeAt(i);</span><br><span class="line">truetruetrue<span class="keyword">if</span> (c &lt; <span class="number">128</span>) &#123;</span><br><span class="line">truetruetruetruestring += <span class="built_in">String</span>.fromCharCode(c);</span><br><span class="line">truetruetruetruei++;</span><br><span class="line">truetruetrue&#125; <span class="keyword">else</span> <span class="keyword">if</span>((c &gt; <span class="number">191</span>) &amp;&amp; (c &lt; <span class="number">224</span>)) &#123;</span><br><span class="line">truetruetruetruec2 = utftext.charCodeAt(i+<span class="number">1</span>);</span><br><span class="line">truetruetruetruestring += <span class="built_in">String</span>.fromCharCode(((c &amp; <span class="number">31</span>) &lt;&lt; <span class="number">6</span>) | (c2 &amp; <span class="number">63</span>));</span><br><span class="line">truetruetruetruei += <span class="number">2</span>;</span><br><span class="line">truetruetrue&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">truetruetruetruec2 = utftext.charCodeAt(i+<span class="number">1</span>);</span><br><span class="line">truetruetruetruec3 = utftext.charCodeAt(i+<span class="number">2</span>);</span><br><span class="line">truetruetruetruestring += <span class="built_in">String</span>.fromCharCode(((c &amp; <span class="number">15</span>) &lt;&lt; <span class="number">12</span>) | ((c2 &amp; <span class="number">63</span>) &lt;&lt; <span class="number">6</span>) | (c3 &amp; <span class="number">63</span>));</span><br><span class="line">truetruetruetruei += <span class="number">3</span>;</span><br><span class="line">truetruetrue&#125;</span><br><span class="line">truetrue&#125;</span><br><span class="line">truetrue<span class="keyword">return</span> string;</span><br><span class="line">true&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h2 id="md5摘要算法"><a href="#md5摘要算法" class="headerlink" title="md5摘要算法"></a>md5摘要算法</h2><p>Base64我们说的差不多了,下面说说md5.<br>md5全称’MD5消息摘要算法’（英语：MD5 Message-Digest Algorithm）,其最明显的作用就是对一段文本或者二进制文件进行运算之后得出一个128位的值,我们通常会把计算结果转换成32个16进制的数来表示.</p><ul><li>对文本进行运算常用于密码的加密,比如对’password2018’这个字符串进行加密之后得到’f4654d5ac34aca487f0e3cb08d769f8a’,由于md5发生碰撞的概率极低,也就是不同的文本加密后得到同样的结果的可能性微乎其微,所以一般可以认为’f4654d5ac34aca487f0e3cb08d769f8a’这样的结果就唯一标识了’password2018’这个字符串.<br>加密容易解密难,如果你想通过’f4654d5ac34aca487f0e3cb08d769f8a’这个结果去逆向运算得到’password2018’这个原始数据几乎是不可能的,付出的成本也相当于是天价,所以我们的网站登录经常会采取用md5加密用户密码的方式来验证和存储用户账户密码.</li><li>对二进制文件的运算常用于确保文件的完整性,比如在一些正规的网站上下载东西时常常附带会有一个<code>.md5</code>的文件,里面的内容类似于<code>MD5 (tanajiya.tar.gz) = 38b8c2c1093dd0fec383a9d9ac940515</code>这样,这里面记录的一串字符就是你要下载的这个文件的md5的运算结果,因为之前说过了一个东西的md5值是唯一的,一个md5结果也同样标识着唯一的一个东西,类似于每个人都有自己独特的指纹一样,一旦这个文件被人篡改过,那么再次对这个文件计算md5就会得到与之前不一样的md5值,所以我们常常会用这个md5结果来验证确保文件的完整性.</li></ul><h3 id="md5的js实现如下"><a href="#md5的js实现如下" class="headerlink" title="md5的js实现如下:"></a>md5的js实现如下:</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message</span></span><br><span class="line"><span class="comment"> * Digest Algorithm, as defined in RFC 1321.</span></span><br><span class="line"><span class="comment"> * Version 2.1 Copyright (C) Paul Johnston 1999 - 2002.</span></span><br><span class="line"><span class="comment"> * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet</span></span><br><span class="line"><span class="comment"> * Distributed under the BSD License</span></span><br><span class="line"><span class="comment"> * See https//pajhome.org.uk/crypt/md5 for more info.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Configurable variables. You may need to tweak these to be compatible with</span></span><br><span class="line"><span class="comment"> * the server-side, but the defaults work in most cases.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> hexcase = <span class="number">0</span>;  <span class="comment">/* hex output format. 0 - lowercase; 1 - uppercase        */</span></span><br><span class="line"><span class="keyword">var</span> b64pad  = <span class="string">""</span>; <span class="comment">/* base-64 pad character. "=" for strict RFC compliance   */</span></span><br><span class="line"><span class="keyword">var</span> chrsz   = <span class="number">8</span>;  <span class="comment">/* bits per input character. 8 - ASCII; 16 - Unicode      */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * These are the functions you'll usually want to call</span></span><br><span class="line"><span class="comment"> * They take string arguments and return either hex or base-64 encoded strings</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hex_md5</span>(<span class="params">s</span>)</span>&#123; <span class="keyword">return</span> binl2hex(core_md5(str2binl(s), s.length * chrsz));&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">b64_md5</span>(<span class="params">s</span>)</span>&#123; <span class="keyword">return</span> binl2b64(core_md5(str2binl(s), s.length * chrsz));&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str_md5</span>(<span class="params">s</span>)</span>&#123; <span class="keyword">return</span> binl2str(core_md5(str2binl(s), s.length * chrsz));&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hex_hmac_md5</span>(<span class="params">key, data</span>) </span>&#123; <span class="keyword">return</span> binl2hex(core_hmac_md5(key, data)); &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">b64_hmac_md5</span>(<span class="params">key, data</span>) </span>&#123; <span class="keyword">return</span> binl2b64(core_hmac_md5(key, data)); &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str_hmac_md5</span>(<span class="params">key, data</span>) </span>&#123; <span class="keyword">return</span> binl2str(core_hmac_md5(key, data)); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Perform a simple self-test to see if the VM is working</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5_vm_test</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> hex_md5(<span class="string">"abc"</span>) == <span class="string">"900150983cd24fb0d6963f7d28e17f72"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Calculate the MD5 of an array of little-endian words, and a bit length</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">core_md5</span>(<span class="params">x, len</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">/* append padding */</span></span><br><span class="line">  x[len &gt;&gt; <span class="number">5</span>] |= <span class="number">0x80</span> &lt;&lt; ((len) % <span class="number">32</span>);</span><br><span class="line">  x[(((len + <span class="number">64</span>) &gt;&gt;&gt; <span class="number">9</span>) &lt;&lt; <span class="number">4</span>) + <span class="number">14</span>] = len;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> a =  <span class="number">1732584193</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">-271733879</span>;</span><br><span class="line">  <span class="keyword">var</span> c = <span class="number">-1732584194</span>;</span><br><span class="line">  <span class="keyword">var</span> d =  <span class="number">271733878</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; x.length; i += <span class="number">16</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> olda = a;</span><br><span class="line">    <span class="keyword">var</span> oldb = b;</span><br><span class="line">    <span class="keyword">var</span> oldc = c;</span><br><span class="line">    <span class="keyword">var</span> oldd = d;</span><br><span class="line"></span><br><span class="line">    a = md5_ff(a, b, c, d, x[i+ <span class="number">0</span>], <span class="number">7</span> , <span class="number">-680876936</span>);</span><br><span class="line">    d = md5_ff(d, a, b, c, x[i+ <span class="number">1</span>], <span class="number">12</span>, <span class="number">-389564586</span>);</span><br><span class="line">    c = md5_ff(c, d, a, b, x[i+ <span class="number">2</span>], <span class="number">17</span>,  <span class="number">606105819</span>);</span><br><span class="line">    b = md5_ff(b, c, d, a, x[i+ <span class="number">3</span>], <span class="number">22</span>, <span class="number">-1044525330</span>);</span><br><span class="line">    a = md5_ff(a, b, c, d, x[i+ <span class="number">4</span>], <span class="number">7</span> , <span class="number">-176418897</span>);</span><br><span class="line">    d = md5_ff(d, a, b, c, x[i+ <span class="number">5</span>], <span class="number">12</span>,  <span class="number">1200080426</span>);</span><br><span class="line">    c = md5_ff(c, d, a, b, x[i+ <span class="number">6</span>], <span class="number">17</span>, <span class="number">-1473231341</span>);</span><br><span class="line">    b = md5_ff(b, c, d, a, x[i+ <span class="number">7</span>], <span class="number">22</span>, <span class="number">-45705983</span>);</span><br><span class="line">    a = md5_ff(a, b, c, d, x[i+ <span class="number">8</span>], <span class="number">7</span> ,  <span class="number">1770035416</span>);</span><br><span class="line">    d = md5_ff(d, a, b, c, x[i+ <span class="number">9</span>], <span class="number">12</span>, <span class="number">-1958414417</span>);</span><br><span class="line">    c = md5_ff(c, d, a, b, x[i+<span class="number">10</span>], <span class="number">17</span>, <span class="number">-42063</span>);</span><br><span class="line">    b = md5_ff(b, c, d, a, x[i+<span class="number">11</span>], <span class="number">22</span>, <span class="number">-1990404162</span>);</span><br><span class="line">    a = md5_ff(a, b, c, d, x[i+<span class="number">12</span>], <span class="number">7</span> ,  <span class="number">1804603682</span>);</span><br><span class="line">    d = md5_ff(d, a, b, c, x[i+<span class="number">13</span>], <span class="number">12</span>, <span class="number">-40341101</span>);</span><br><span class="line">    c = md5_ff(c, d, a, b, x[i+<span class="number">14</span>], <span class="number">17</span>, <span class="number">-1502002290</span>);</span><br><span class="line">    b = md5_ff(b, c, d, a, x[i+<span class="number">15</span>], <span class="number">22</span>,  <span class="number">1236535329</span>);</span><br><span class="line"></span><br><span class="line">    a = md5_gg(a, b, c, d, x[i+ <span class="number">1</span>], <span class="number">5</span> , <span class="number">-165796510</span>);</span><br><span class="line">    d = md5_gg(d, a, b, c, x[i+ <span class="number">6</span>], <span class="number">9</span> , <span class="number">-1069501632</span>);</span><br><span class="line">    c = md5_gg(c, d, a, b, x[i+<span class="number">11</span>], <span class="number">14</span>,  <span class="number">643717713</span>);</span><br><span class="line">    b = md5_gg(b, c, d, a, x[i+ <span class="number">0</span>], <span class="number">20</span>, <span class="number">-373897302</span>);</span><br><span class="line">    a = md5_gg(a, b, c, d, x[i+ <span class="number">5</span>], <span class="number">5</span> , <span class="number">-701558691</span>);</span><br><span class="line">    d = md5_gg(d, a, b, c, x[i+<span class="number">10</span>], <span class="number">9</span> ,  <span class="number">38016083</span>);</span><br><span class="line">    c = md5_gg(c, d, a, b, x[i+<span class="number">15</span>], <span class="number">14</span>, <span class="number">-660478335</span>);</span><br><span class="line">    b = md5_gg(b, c, d, a, x[i+ <span class="number">4</span>], <span class="number">20</span>, <span class="number">-405537848</span>);</span><br><span class="line">    a = md5_gg(a, b, c, d, x[i+ <span class="number">9</span>], <span class="number">5</span> ,  <span class="number">568446438</span>);</span><br><span class="line">    d = md5_gg(d, a, b, c, x[i+<span class="number">14</span>], <span class="number">9</span> , <span class="number">-1019803690</span>);</span><br><span class="line">    c = md5_gg(c, d, a, b, x[i+ <span class="number">3</span>], <span class="number">14</span>, <span class="number">-187363961</span>);</span><br><span class="line">    b = md5_gg(b, c, d, a, x[i+ <span class="number">8</span>], <span class="number">20</span>,  <span class="number">1163531501</span>);</span><br><span class="line">    a = md5_gg(a, b, c, d, x[i+<span class="number">13</span>], <span class="number">5</span> , <span class="number">-1444681467</span>);</span><br><span class="line">    d = md5_gg(d, a, b, c, x[i+ <span class="number">2</span>], <span class="number">9</span> , <span class="number">-51403784</span>);</span><br><span class="line">    c = md5_gg(c, d, a, b, x[i+ <span class="number">7</span>], <span class="number">14</span>,  <span class="number">1735328473</span>);</span><br><span class="line">    b = md5_gg(b, c, d, a, x[i+<span class="number">12</span>], <span class="number">20</span>, <span class="number">-1926607734</span>);</span><br><span class="line"></span><br><span class="line">    a = md5_hh(a, b, c, d, x[i+ <span class="number">5</span>], <span class="number">4</span> , <span class="number">-378558</span>);</span><br><span class="line">    d = md5_hh(d, a, b, c, x[i+ <span class="number">8</span>], <span class="number">11</span>, <span class="number">-2022574463</span>);</span><br><span class="line">    c = md5_hh(c, d, a, b, x[i+<span class="number">11</span>], <span class="number">16</span>,  <span class="number">1839030562</span>);</span><br><span class="line">    b = md5_hh(b, c, d, a, x[i+<span class="number">14</span>], <span class="number">23</span>, <span class="number">-35309556</span>);</span><br><span class="line">    a = md5_hh(a, b, c, d, x[i+ <span class="number">1</span>], <span class="number">4</span> , <span class="number">-1530992060</span>);</span><br><span class="line">    d = md5_hh(d, a, b, c, x[i+ <span class="number">4</span>], <span class="number">11</span>,  <span class="number">1272893353</span>);</span><br><span class="line">    c = md5_hh(c, d, a, b, x[i+ <span class="number">7</span>], <span class="number">16</span>, <span class="number">-155497632</span>);</span><br><span class="line">    b = md5_hh(b, c, d, a, x[i+<span class="number">10</span>], <span class="number">23</span>, <span class="number">-1094730640</span>);</span><br><span class="line">    a = md5_hh(a, b, c, d, x[i+<span class="number">13</span>], <span class="number">4</span> ,  <span class="number">681279174</span>);</span><br><span class="line">    d = md5_hh(d, a, b, c, x[i+ <span class="number">0</span>], <span class="number">11</span>, <span class="number">-358537222</span>);</span><br><span class="line">    c = md5_hh(c, d, a, b, x[i+ <span class="number">3</span>], <span class="number">16</span>, <span class="number">-722521979</span>);</span><br><span class="line">    b = md5_hh(b, c, d, a, x[i+ <span class="number">6</span>], <span class="number">23</span>,  <span class="number">76029189</span>);</span><br><span class="line">    a = md5_hh(a, b, c, d, x[i+ <span class="number">9</span>], <span class="number">4</span> , <span class="number">-640364487</span>);</span><br><span class="line">    d = md5_hh(d, a, b, c, x[i+<span class="number">12</span>], <span class="number">11</span>, <span class="number">-421815835</span>);</span><br><span class="line">    c = md5_hh(c, d, a, b, x[i+<span class="number">15</span>], <span class="number">16</span>,  <span class="number">530742520</span>);</span><br><span class="line">    b = md5_hh(b, c, d, a, x[i+ <span class="number">2</span>], <span class="number">23</span>, <span class="number">-995338651</span>);</span><br><span class="line"></span><br><span class="line">    a = md5_ii(a, b, c, d, x[i+ <span class="number">0</span>], <span class="number">6</span> , <span class="number">-198630844</span>);</span><br><span class="line">    d = md5_ii(d, a, b, c, x[i+ <span class="number">7</span>], <span class="number">10</span>,  <span class="number">1126891415</span>);</span><br><span class="line">    c = md5_ii(c, d, a, b, x[i+<span class="number">14</span>], <span class="number">15</span>, <span class="number">-1416354905</span>);</span><br><span class="line">    b = md5_ii(b, c, d, a, x[i+ <span class="number">5</span>], <span class="number">21</span>, <span class="number">-57434055</span>);</span><br><span class="line">    a = md5_ii(a, b, c, d, x[i+<span class="number">12</span>], <span class="number">6</span> ,  <span class="number">1700485571</span>);</span><br><span class="line">    d = md5_ii(d, a, b, c, x[i+ <span class="number">3</span>], <span class="number">10</span>, <span class="number">-1894986606</span>);</span><br><span class="line">    c = md5_ii(c, d, a, b, x[i+<span class="number">10</span>], <span class="number">15</span>, <span class="number">-1051523</span>);</span><br><span class="line">    b = md5_ii(b, c, d, a, x[i+ <span class="number">1</span>], <span class="number">21</span>, <span class="number">-2054922799</span>);</span><br><span class="line">    a = md5_ii(a, b, c, d, x[i+ <span class="number">8</span>], <span class="number">6</span> ,  <span class="number">1873313359</span>);</span><br><span class="line">    d = md5_ii(d, a, b, c, x[i+<span class="number">15</span>], <span class="number">10</span>, <span class="number">-30611744</span>);</span><br><span class="line">    c = md5_ii(c, d, a, b, x[i+ <span class="number">6</span>], <span class="number">15</span>, <span class="number">-1560198380</span>);</span><br><span class="line">    b = md5_ii(b, c, d, a, x[i+<span class="number">13</span>], <span class="number">21</span>,  <span class="number">1309151649</span>);</span><br><span class="line">    a = md5_ii(a, b, c, d, x[i+ <span class="number">4</span>], <span class="number">6</span> , <span class="number">-145523070</span>);</span><br><span class="line">    d = md5_ii(d, a, b, c, x[i+<span class="number">11</span>], <span class="number">10</span>, <span class="number">-1120210379</span>);</span><br><span class="line">    c = md5_ii(c, d, a, b, x[i+ <span class="number">2</span>], <span class="number">15</span>,  <span class="number">718787259</span>);</span><br><span class="line">    b = md5_ii(b, c, d, a, x[i+ <span class="number">9</span>], <span class="number">21</span>, <span class="number">-343485551</span>);</span><br><span class="line"></span><br><span class="line">    a = safe_add(a, olda);</span><br><span class="line">    b = safe_add(b, oldb);</span><br><span class="line">    c = safe_add(c, oldc);</span><br><span class="line">    d = safe_add(d, oldd);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>(a, b, c, d);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * These functions implement the four basic operations the algorithm uses.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5_cmn</span>(<span class="params">q, a, b, x, s, t</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s),b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5_ff</span>(<span class="params">a, b, c, d, x, s, t</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> md5_cmn((b &amp; c) | ((~b) &amp; d), a, b, x, s, t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5_gg</span>(<span class="params">a, b, c, d, x, s, t</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> md5_cmn((b &amp; d) | (c &amp; (~d)), a, b, x, s, t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5_hh</span>(<span class="params">a, b, c, d, x, s, t</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> md5_cmn(b ^ c ^ d, a, b, x, s, t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5_ii</span>(<span class="params">a, b, c, d, x, s, t</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> md5_cmn(c ^ (b | (~d)), a, b, x, s, t);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Calculate the HMAC-MD5, of a key and some data</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">core_hmac_md5</span>(<span class="params">key, data</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> bkey = str2binl(key);</span><br><span class="line">  <span class="keyword">if</span>(bkey.length &gt; <span class="number">16</span>) bkey = core_md5(bkey, key.length * chrsz);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> ipad = <span class="built_in">Array</span>(<span class="number">16</span>), opad = <span class="built_in">Array</span>(<span class="number">16</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    ipad[i] = bkey[i] ^ <span class="number">0x36363636</span>;</span><br><span class="line">    opad[i] = bkey[i] ^ <span class="number">0x5C5C5C5C</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> hash = core_md5(ipad.concat(str2binl(data)), <span class="number">512</span> + data.length * chrsz);</span><br><span class="line">  <span class="keyword">return</span> core_md5(opad.concat(hash), <span class="number">512</span> + <span class="number">128</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Add integers, wrapping at 2^32. This uses 16-bit operations internally</span></span><br><span class="line"><span class="comment"> * to work around bugs in some JS interpreters.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_add</span>(<span class="params">x, y</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> lsw = (x &amp; <span class="number">0xFFFF</span>) + (y &amp; <span class="number">0xFFFF</span>);</span><br><span class="line">  <span class="keyword">var</span> msw = (x &gt;&gt; <span class="number">16</span>) + (y &gt;&gt; <span class="number">16</span>) + (lsw &gt;&gt; <span class="number">16</span>);</span><br><span class="line">  <span class="keyword">return</span> (msw &lt;&lt; <span class="number">16</span>) | (lsw &amp; <span class="number">0xFFFF</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Bitwise rotate a 32-bit number to the left.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bit_rol</span>(<span class="params">num, cnt</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (num &lt;&lt; cnt) | (num &gt;&gt;&gt; (<span class="number">32</span> - cnt));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Convert a string to an array of little-endian words</span></span><br><span class="line"><span class="comment"> * If chrsz is ASCII, characters &gt;255 have their hi-byte silently ignored.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str2binl</span>(<span class="params">str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> bin = <span class="built_in">Array</span>();</span><br><span class="line">  <span class="keyword">var</span> mask = (<span class="number">1</span> &lt;&lt; chrsz) - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.length * chrsz; i += chrsz)</span><br><span class="line">    bin[i&gt;&gt;<span class="number">5</span>] |= (str.charCodeAt(i / chrsz) &amp; mask) &lt;&lt; (i%<span class="number">32</span>);</span><br><span class="line">  <span class="keyword">return</span> bin;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Convert an array of little-endian words to a string</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">binl2str</span>(<span class="params">bin</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> str = <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">var</span> mask = (<span class="number">1</span> &lt;&lt; chrsz) - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; bin.length * <span class="number">32</span>; i += chrsz)</span><br><span class="line">    str += <span class="built_in">String</span>.fromCharCode((bin[i&gt;&gt;<span class="number">5</span>] &gt;&gt;&gt; (i % <span class="number">32</span>)) &amp; mask);</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Convert an array of little-endian words to a hex string.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">binl2hex</span>(<span class="params">binarray</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> hex_tab = hexcase ? <span class="string">"0123456789ABCDEF"</span> : <span class="string">"0123456789abcdef"</span>;</span><br><span class="line">  <span class="keyword">var</span> str = <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; binarray.length * <span class="number">4</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    str += hex_tab.charAt((binarray[i&gt;&gt;<span class="number">2</span>] &gt;&gt; ((i%<span class="number">4</span>)*<span class="number">8</span>+<span class="number">4</span>)) &amp; <span class="number">0xF</span>) +</span><br><span class="line">           hex_tab.charAt((binarray[i&gt;&gt;<span class="number">2</span>] &gt;&gt; ((i%<span class="number">4</span>)*<span class="number">8</span>  )) &amp; <span class="number">0xF</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Convert an array of little-endian words to a base-64 string</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">binl2b64</span>(<span class="params">binarray</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> tab = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line">  <span class="keyword">var</span> str = <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; binarray.length * <span class="number">4</span>; i += <span class="number">3</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> triplet = (((binarray[i   &gt;&gt; <span class="number">2</span>] &gt;&gt; <span class="number">8</span> * ( i   %<span class="number">4</span>)) &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">16</span>)</span><br><span class="line">                | (((binarray[i+<span class="number">1</span> &gt;&gt; <span class="number">2</span>] &gt;&gt; <span class="number">8</span> * ((i+<span class="number">1</span>)%<span class="number">4</span>)) &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">8</span> )</span><br><span class="line">                |  ((binarray[i+<span class="number">2</span> &gt;&gt; <span class="number">2</span>] &gt;&gt; <span class="number">8</span> * ((i+<span class="number">2</span>)%<span class="number">4</span>)) &amp; <span class="number">0xFF</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(i * <span class="number">8</span> + j * <span class="number">6</span> &gt; binarray.length * <span class="number">32</span>) str += b64pad;</span><br><span class="line">      <span class="keyword">else</span> str += tab.charAt((triplet &gt;&gt; <span class="number">6</span>*(<span class="number">3</span>-j)) &amp; <span class="number">0x3F</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="article-tags tags iconfont icon-tag"><a href="/tags/encrypt/">encrypt</a></div><div class="art-item-footer"><span class="art-item-left"><i class="iconfont icon-arrow-circle-left"></i>上一篇: <a href="/Airbnb-JavaScript-Style-Guide/" rel="prev" title="Airbnb 代码规范阅读笔记">Airbnb 代码规范阅读笔记 </a></span><span class="art-item-right">下一篇: <a href="/IIFE/" rel="next" title="IIFE">IIFE </a><i class="iconfont icon-arrow-circle-right"></i></span></div></section></article><script>window.subData={title:"Base64-md5",subtitle:"",tools:!0}</script></div><aside class="l_side"><section class="m_widget about"><img class="avatar" src="" data-src="/images/avatar_blog.png"><div class="content"><div class="desc">Developers&#39; lives matter.</div></div></section><section class="m_widget categories"><div class="header">Categories</div><div class="content"><ul class="entry"><li><a class="flat-box" href="/categories/daily/"><div class="name">daily</div><div class="badget">1</div></a></li><li><a class="flat-box" href="/categories/database/"><div class="name">database</div><div class="badget">1</div></a></li><li><a class="flat-box" href="/categories/framework/"><div class="name">framework</div><div class="badget">1</div></a></li><li><a class="flat-box" href="/categories/front-end/"><div class="name">front-end</div><div class="badget">27</div></a></li><li><a class="flat-box" href="/categories/http/"><div class="name">http</div><div class="badget">2</div></a></li><li><a class="flat-box" href="/categories/tool/"><div class="name">tool</div><div class="badget">6</div></a></li><li><a class="flat-box" href="/categories/translation/"><div class="name">translation</div><div class="badget">1</div></a></li></ul></div></section><div class="m_widget tagcloud"><div class="header">Tags</div><div class="content"><a href="/tags/AST/" style="font-size:14px;color:grey">AST</a> <a href="/tags/CORS/" style="font-size:14px;color:grey">CORS</a> <a href="/tags/CSS/" style="font-size:14px;color:grey">CSS</a> <a href="/tags/Content-Type/" style="font-size:14px;color:grey">Content-Type</a> <a href="/tags/ES6/" style="font-size:17px;color:#404040">ES6</a> <a href="/tags/HTTP/" style="font-size:14px;color:grey">HTTP</a> <a href="/tags/HTTP-2-0/" style="font-size:14px;color:grey">HTTP/2.0</a> <a href="/tags/JavaScript/" style="font-size:14px;color:grey">JavaScript</a> <a href="/tags/MVC/" style="font-size:14px;color:grey">MVC</a> <a href="/tags/MVP/" style="font-size:14px;color:grey">MVP</a> <a href="/tags/MVVM/" style="font-size:14px;color:grey">MVVM</a> <a href="/tags/Mini-Program/" style="font-size:14px;color:grey">Mini-Program</a> <a href="/tags/SASS/" style="font-size:14px;color:grey">SASS</a> <a href="/tags/ast/" style="font-size:14px;color:grey">ast</a> <a href="/tags/async/" style="font-size:14px;color:grey">async</a> <a href="/tags/callback/" style="font-size:14px;color:grey">callback</a> <a href="/tags/codeStyle/" style="font-size:14px;color:grey">codeStyle</a> <a href="/tags/cookie/" style="font-size:14px;color:grey">cookie</a> <a href="/tags/css/" style="font-size:20px;color:#000">css</a> <a href="/tags/docker/" style="font-size:14px;color:grey">docker</a> <a href="/tags/elasticsearch/" style="font-size:14px;color:grey">elasticsearch</a> <a href="/tags/encrypt/" style="font-size:17px;color:#404040">encrypt</a> <a href="/tags/flex/" style="font-size:14px;color:grey">flex</a> <a href="/tags/function/" style="font-size:14px;color:grey">function</a> <a href="/tags/git/" style="font-size:20px;color:#000">git</a> <a href="/tags/h5/" style="font-size:17px;color:#404040">h5</a> <a href="/tags/http/" style="font-size:14px;color:grey">http</a> <a href="/tags/javascript/" style="font-size:14px;color:grey">javascript</a> <a href="/tags/js怪异事件录/" style="font-size:14px;color:grey">js怪异事件录</a> <a href="/tags/markdown/" style="font-size:14px;color:grey">markdown</a> <a href="/tags/nginx/" style="font-size:14px;color:grey">nginx</a> <a href="/tags/nodejs/" style="font-size:14px;color:grey">nodejs</a> <a href="/tags/object/" style="font-size:14px;color:grey">object</a> <a href="/tags/optimize/" style="font-size:14px;color:grey">optimize</a> <a href="/tags/promise/" style="font-size:14px;color:grey">promise</a> <a href="/tags/react/" style="font-size:14px;color:grey">react</a> <a href="/tags/redux/" style="font-size:14px;color:grey">redux</a> <a href="/tags/same-origin/" style="font-size:14px;color:grey">same-origin</a> <a href="/tags/service-worker/" style="font-size:14px;color:grey">service-worker</a> <a href="/tags/shell/" style="font-size:14px;color:grey">shell</a> <a href="/tags/speed/" style="font-size:14px;color:grey">speed</a> <a href="/tags/ssh/" style="font-size:14px;color:grey">ssh</a> <a href="/tags/toLocaleString/" style="font-size:14px;color:grey">toLocaleString</a> <a href="/tags/vue/" style="font-size:14px;color:grey">vue</a> <a href="/tags/web-font/" style="font-size:14px;color:grey">web-font</a> <a href="/tags/web优化/" style="font-size:14px;color:grey">web优化</a> <a href="/tags/yahoo/" style="font-size:14px;color:grey">yahoo</a> <a href="/tags/前端模块化/" style="font-size:14px;color:grey">前端模块化</a> <a href="/tags/国际化/" style="font-size:14px;color:grey">国际化</a></div></div><section class="m_widget links"><div class="header">Links</div><div class="content"><ul class="entry"><li><a class="flat-box" target="_blank" href="https://996.icu/#/zh_CN"><div class="name">996.icu</div></a></li></ul></div></section></aside></div></div><footer class="l_footer clearfix" style="display:none"><div class="copyright">©2018 By <a href="https://github.com/kricsleo">kricsleo</a></div><div class="framework-info">Diven - <a href="https://hexo.io/zh-cn/">Hexo</a></div></footer><script>function loadCSS() {
    const doc = document;
    const link = doc.createElement('link');
    link.rel = 'stylesheet';
    link.href = '/style.css';
    // link.href = 'https://store.kricsleo.com/blog/static/css/style.css';
    link.onload = () => {
      const dLoader = doc.getElementsByClassName('loader')[0];
      dLoader.style.opacity = 0;
      setTimeout(() => {
        dLoader.parentNode.removeChild(dLoader);
      }, 400);
    }
    doc.head.appendChild(link);
  }
  loadCSS();</script><script src="/js/index.js"></script></body>